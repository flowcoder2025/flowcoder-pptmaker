# PPT Maker 프로젝트 구현 히스토리

> **문서 목적**: Phase별 구현 내용 및 기술적 의사결정 기록
> **최종 업데이트**: 2025-11-06

---

## 개요

PPT Maker는 4개의 Phase를 거쳐 개발되었으며, 각 Phase는 명확한 목표와 기술적 성과를 달성했습니다.

**전체 타임라인**:
- Phase 1: 템플릿 시스템 구축 (완료 ✅)
- Phase 2: 기본 편집 기능 (완료 ✅)
- Phase 3: 고급 편집 기능 (구현 준비 중)
- Phase 4: 수익화 시스템 (구현 준비 중)

---

## Phase 1: 기본 템플릿 시스템 (완료 ✅)

### Phase 목표
클라이언트 템플릿 시스템 구축으로 Gemini API 비용 98% 절감 (100원 → 2원)
- **Parser 통합**: 콘텐츠 생성 시 UnifiedPPTJSON 직접 생성 (8원 절감)
- **HTML 클라이언트 생성**: 템플릿 엔진으로 HTML 생성 (75-82원 절감)

### 주요 구현 내용

#### 1. 템플릿 엔진 코어
- TemplateEngine 및 TemplateRegistry 구현
- 12개 전체 슬라이드 타입 지원
  - Title, Content, Bullet, Section
  - Table, Chart, Stats, Comparison
  - Timeline, Quote, ThankYou, TwoColumn
- Pro 버전 HTML 패턴을 완벽 재현한 TossDefaultTemplate

#### 2. 타입 시스템 확장
- Presentation 타입에 `slideData`, `templateId`, `updatedAt` 필드 추가
- UnifiedPPTJSON 구조화 데이터로 편집 가능성 확보

#### 3. Store 통합
- Gemini Parser + HTML API 호출 제거 (83-90원 → 0원)
- 콘텐츠 생성 시 UnifiedPPTJSON 직접 생성 (Parser 8원 절감)
- TemplateEngine.generateAll로 HTML 생성 (HTML 75-82원 절감)
- slideData 저장으로 편집 기능 준비

### 완료된 작업
- ✅ 타입 정의 (TemplateContext, SlideTemplate, HTMLSlide)
- ✅ TemplateRegistry 구현 (템플릿 등록/관리 시스템)
- ✅ TemplateEngine 구현 (HTML 생성 엔진)
- ✅ TossDefaultTemplate 구현 (12개 슬라이드 타입)
- ✅ Export 모듈 구성
- ✅ Presentation 타입 확장
- ✅ Store 통합 (HTML 생성 로직 교체)
- ✅ 테스트 및 검증

### 기술적 의사결정

#### 1. Pro 버전 패턴 채택
**결정**: Flash보다 품질 높은 Pro HTML 구조 분석 및 재현

**근거**:
- Pro 모델 HTML이 더 깔끔하고 일관성 있음
- Flash 모델은 가끔 불필요한 스타일 중복 생성
- Pro 패턴이 편집 후 재생성 시에도 안정적

**결과**:
- 품질 저하 없이 비용 98% 절감
- 편집 시에도 동일한 품질 유지

#### 2. Parser 통합
**결정**: 콘텐츠 생성 시 UnifiedPPTJSON 형식 직접 생성

**근거**:
- Parser API 비용 완전 제거 (8원 절감)
- 단일 API 호출로 프로세스 단순화
- 파싱 실패 위험 감소 (프롬프트 제어)

**결과**:
- 3단계 파이프라인 (기존 4단계에서 Parser 제거)
- Parser 비용 100% 절감 (8원 → 0원)
- 생성 속도 개선 (API 호출 1회 감소)

#### 3. 클라이언트 HTML 생성
**결정**: API 대신 클라이언트에서 HTML 생성

**근거**:
- HTML 생성 API 비용 완전 제거 (75-82원 → 0원)
- 편집 시 즉시 재생성 가능 (네트워크 지연 없음)
- 오프라인에서도 작동 가능

**결과**:
- 생성 비용: 100원 → 2원 (98% 절감)
- 편집 시 추가 비용 없음
- 편집 경험 대폭 개선 (< 100ms 재생성)

#### 4. 12개 타입 전체 구현
**결정**: 향후 확장성 확보, Phase 2 편집 준비

**근거**:
- 처음부터 전체 타입 구현으로 일관성 확보
- 부분 구현 시 나중에 패턴 불일치 발생 가능
- 편집 기능 구현 시 타입별 폼 필요

**결과**:
- Phase 2 편집 기능 즉시 시작 가능
- 타입별 일관성 확보
- 향후 템플릿 추가 시 참조 가능한 완전한 예제

#### 5. 하위 호환성 유지
**결정**: slideData optional로 기존 프리젠테이션 정상 로드

**근거**:
- Phase 1 이전에 생성된 프리젠테이션 호환성
- 점진적 마이그레이션 가능
- 사용자 경험 저하 방지

**결과**:
- 기존 프리젠테이션 정상 로드
- 편집 시도 시 안내 메시지 표시
- 데이터 손실 없음

### 성과 지표

**비용 절감**:
- 기존 (Phase 0): 콘텐츠 (₩2) + Parser (₩8) + HTML (₩75-82) = **₩85-92/회**
- 개선 (Phase 1): 콘텐츠+JSON (₩2) + 템플릿 (₩0) = **₩2/회**
- **절감률: 98%** (최대 ₩90/회 절감)

**핵심 개선**:
- ✅ **Parser 통합**: Flash-Lite API 제거 (8원 절감)
- ✅ **HTML 클라이언트 생성**: Pro API 제거 (75-82원 절감)
- ✅ **3단계 파이프라인**: 기존 4단계에서 Parser 제거

**성능 개선**:
- HTML 생성 시간: 2-3초 → < 100ms
- 편집 시 재생성: 즉시 (네트워크 지연 없음)

---

## Phase 2: 편집 기능 시스템 (완료 ✅)

### Phase 목표
생성된 프리젠테이션을 앱 내에서 편집하여 추가 AI 비용 없이 개선

### 주요 구현 내용

#### 1. Editor 페이지 라우팅
- 2열 레이아웃 (편집 폼 + 실시간 미리보기)
- 슬라이드 선택 UI (썸네일 리스트)
- 상단 네비게이션 (뒤로가기, 저장 버튼)

#### 2. 12개 타입별 편집 폼
각 슬라이드 타입별 전용 편집 폼:
- **TitleSlideForm**: 제목, 부제목
- **ContentSlideForm**: 제목, 본문 textarea
- **BulletSlideForm**: 리스트 항목 동적 추가/삭제
- **SectionSlideForm**: 섹션 제목
- **TableSlideForm**: 헤더, 행 편집
- **ChartSlideForm**: 데이터 포인트
- **StatsSlideForm**: 2×2 통계 카드
- **ComparisonSlideForm**: 좌우 항목
- **TimelineSlideForm**: 타임라인 항목
- **QuoteSlideForm**: 인용문, 저자
- **ThankYouSlideForm**: 제목, 부제목, 연락처
- **TwoColumnSlideForm**: 좌우 컬럼

#### 3. 실시간 미리보기
- TemplateEngine 즉시 재호출 (< 100ms)
- 편집 내용 즉시 반영

#### 4. Store 확장
- `updateSlide` 액션 구현
- `savePresentation` 액션 (LocalStorage)
- slideData 수정 → HTML 자동 재생성

### 완료된 작업
- ✅ Editor 페이지 라우팅 및 기본 레이아웃
- ✅ 슬라이드 선택 UI (SlideList)
- ✅ 편집 폼 시스템 (EditForm 라우터)
- ✅ 12개 타입별 편집 폼 컴포넌트
- ✅ 실시간 미리보기 시스템 (SlidePreview)
- ✅ 변경사항 저장 및 Store 통합
- ✅ 라우팅 통합 (viewer ↔ editor 양방향)
- ✅ 테스트 및 검증

### 기술적 의사결정

#### 1. 즉시 미리보기
**결정**: Debounce 없이 즉시 반영

**근거**:
- TemplateEngine 충분히 빠름 (< 100ms)
- 사용자가 타이핑하면서 실시간 확인 가능
- Debounce는 오히려 사용자 경험 저하

**결과**:
- 타이핑 즉시 미리보기 업데이트
- 부드러운 편집 경험
- 성능 문제 없음

#### 2. 전체 재생성
**결정**: 슬라이드 1개 편집 시 전체 HTML 재생성

**근거**:
- 템플릿 엔진이 충분히 빠름 (< 100ms)
- 부분 업데이트는 일관성 문제 발생 가능
- 안전성 우선

**결과**:
- 일관성 보장
- 성능 저하 없음
- 간단한 구현

#### 3. LocalStorage 저장
**결정**: 서버 없이 클라이언트 저장

**근거**:
- MVP 단계에서 서버 불필요
- 즉시 저장 가능 (네트워크 지연 없음)
- 향후 서버 연동 확장 가능

**결과**:
- 빠른 저장/로드
- 오프라인 작동 가능
- Phase 4에서 서버 연동 추가 예정

### 성과 지표

**편집 비용**:
- 기존 방식: 편집 시 AI 재생성 필요 (₩169-176/회)
- 개선 방식: **₩0/회** (무제한 편집 가능)

**편집 성능**:
- 미리보기 업데이트: < 100ms
- 저장 시간: < 50ms (LocalStorage)

---

## Phase 3: 고급 편집 기능 (구현 준비 중)

### Phase 목표
슬라이드 관리 고도화 및 편집 히스토리로 전문적인 프리젠테이션 편집 환경 제공

### 주요 구현 내용

#### 1. 슬라이드 순서 변경
- react-beautiful-dnd 라이브러리 사용
- Drag & Drop으로 직관적 재구성
- `reorderSlides` Store 액션

#### 2. 슬라이드 추가 기능
- 12개 타입 선택 대화상자
- 기본 데이터로 새 슬라이드 생성
- `addSlide` Store 액션

#### 3. 슬라이드 삭제 기능
- 삭제 확인 대화상자
- 마지막 슬라이드 삭제 방지
- `deleteSlide` Store 액션

#### 4. 슬라이드 복제 기능
- Deep Copy로 완전 복제
- `duplicateSlide` Store 액션

#### 5. 템플릿 변경 시스템
- 무료 ↔ 프리미엄 전환
- 프리미엄 템플릿 2개 추가 (Modern, Minimal)
- `changeTemplate` Store 액션

#### 6. 편집 히스토리 (Undo/Redo)
- 10단계 히스토리 스택 구조
- Ctrl+Z, Ctrl+Shift+Z 키보드 단축키
- `undo`, `redo` 액션 구현

#### 7. 이미지 업로드 (선택사항)
- 드래그 & 드롭 업로드
- Base64 인코딩 및 저장
- 최대 2MB 제한

### 미완료 작업
- [ ] 슬라이드 순서 변경 (react-beautiful-dnd)
- [ ] 슬라이드 추가/삭제 UI 및 로직
- [ ] 편집 히스토리 시스템 (Undo/Redo)
- [ ] 템플릿 변경 시스템
- [ ] 복제 기능
- [ ] 이미지 업로드 (선택사항)

### 기술적 의사결정

#### 1. react-beautiful-dnd 선택
**이유**:
- 설정 간단
- 애니메이션 기본 제공
- 터치 지원 (모바일 환경)
- 커뮤니티 검증된 라이브러리

#### 2. 히스토리 스택 10개 제한
**이유**:
- 메모리 사용량 관리
- 대부분의 사용자는 10단계 이상 되돌리지 않음
- 모바일 환경 고려

#### 3. 프리미엄 템플릿 추가
**이유**:
- 수익화 준비 (Phase 4 연계)
- 사용자에게 선택권 제공
- 무료 템플릿도 충분히 품질 높게 유지

---

## Phase 4: 수익화 (구현 준비 중)

### Phase 목표
토스 로그인, 토스페이, IAP 연동으로 구독 기반 수익 모델 구축

### 주요 구현 내용

#### 1. 토스 로그인 (필수 선행 작업)
- OAuth 연동 (`appLogin()`)
- 서버 사이드 토큰 발급
- 사용자 정보 복호화 및 저장
- 연결 끊기 콜백 처리

#### 2. 토스페이 구독 결제
- `checkoutPayment()` API 연동
- payToken 생성 및 결제 실행
- 구독 상태 DB 저장

#### 3. IAP 프리미엄 템플릿 판매
- `createOneTimePurchaseOrder()` 연동
- SKU 상품 정의 및 등록
- 영수증 서버 검증
- 템플릿 잠금 해제

#### 4. 구독 모델 (3-Tier)
- **Basic (무료)**: 10개 슬라이드/월
- **Pro (₩9,900/월)**: 200개 슬라이드/월 + 프리미엄 템플릿
- **Enterprise (₩29,900/월)**: 무제한 + 독점 템플릿

#### 5. 사용량 추적 시스템
- 월별 슬라이드 카운트
- 플랜별 제한 적용
- 업그레이드 프롬프트

#### 6. 스토어 UI
- 구독 플랜 비교 카드
- 프리미엄 템플릿 갤러리
- 결제 대화상자

#### 7. 서버 사이드 검증
- 영수증 위변조 방지
- 결제 재검증
- 환불 처리 로직

### 완료된 작업
- ✅ 타입 정의 (auth.ts, payment.ts, iap.ts)
- ✅ 로그인 Hook 및 API (구조 구현 완료)
- ✅ 토스페이 Hook 및 API (구조 구현 완료)
- ✅ IAP Hook 및 API (구조 구현 완료)
- ✅ 구독 Store (Zustand + persist)
- ✅ 사용량 Store (월별 자동 초기화)

### 미완료 작업
- [ ] 실제 DB 연동 (현재는 구조만 구현)
- [ ] 스토어 UI 완성 (핵심 Hook은 완료, UI는 향후 추가)
- [ ] 프로덕션 환경 테스트

### 기술적 의사결정

#### 1. WebView 프레임워크 사용
**결정**: `@apps-in-toss/web-framework` (React Native Bedrock 아님)

**근거**:
- 프로젝트는 WebView 타입
- React Native Bedrock는 React Native 전용
- 잘못된 프레임워크 사용 시 런타임 에러

**결과**:
- 올바른 프레임워크 선택
- Apps in Toss WebView 환경에서 정상 작동

#### 2. 토스 로그인 필수
**결정**: 토스페이 사용을 위한 선행 조건

**근거**:
- 토스페이는 토스 회원 정보 필요
- OAuth 토큰으로 사용자 식별
- 보안 및 결제 안정성

**결과**:
- 안전한 결제 프로세스
- 사용자 정보 연동

#### 3. 서버 사이드 검증 강제
**결정**: 모든 결제는 서버에서 재검증

**근거**:
- 클라이언트 검증만으로는 위변조 가능
- 영수증 서버 검증 필수
- Apps in Toss 정책 준수

**결과**:
- 결제 보안 강화
- 부정 결제 방지

#### 4. 구독 모델 3단계
**결정**: Basic (무료) → Pro (₩9,900) → Enterprise (₩29,900)

**근거**:
- Basic: 무료 사용자 확보
- Pro: 대부분의 사용자 타겟 (월 200개 충분)
- Enterprise: 전문가/기업 타겟 (무제한)

**결과**:
- 다양한 사용자층 확보
- 유연한 가격 정책

#### 5. IAP와 토스페이 병행
**결정**: 구독(토스페이) + 템플릿(IAP)

**근거**:
- 구독: 반복 수익 (안정적)
- IAP: 일회성 수익 (프리미엄 템플릿)
- 사용자 선택권 제공

**결과**:
- 수익 다각화
- 사용자 편의성 제공

---

## 전체 프로젝트 요약

### 완료된 Phase
- ✅ **Phase 1**: 템플릿 시스템 (98% 비용 절감 - Parser 통합 + HTML 클라이언트 생성)
- ✅ **Phase 2**: 기본 편집 (무제한 편집)

### 진행 중인 Phase
- 🚧 **Phase 3**: 고급 편집 (준비 중)
- 🚧 **Phase 4**: 수익화 (구조 완료, UI 개발 중)

### 핵심 성과

**비용 절감**:
- 생성 비용: ₩85-92 → ₩2 (98% 절감)
  - Parser 통합: 8원 절감
  - HTML 클라이언트 생성: 75-82원 절감
- 편집 비용: ₩85-92/회 → ₩0/회 (무제한)

**기능 완성도**:
- ✅ 12개 슬라이드 타입 완전 지원
- ✅ 실시간 미리보기 시스템
- ✅ 무제한 편집 기능

**수익 모델**:
- 템플릿 판매: 94-97% 마진
- 구독 모델: 3단계 (₩0 / ₩9,900 / ₩29,900)

### 다음 우선순위

1. **Phase 3 완료** (고급 편집 기능)
   - 슬라이드 순서 변경
   - 추가/삭제/복제
   - Undo/Redo

2. **Phase 4 완료** (수익화 시스템)
   - 스토어 UI 완성
   - DB 연동
   - 프로덕션 테스트

3. **Phase 5 준비** (향후 계획)
   - 협업 편집
   - 엔터프라이즈 기능
   - 글로벌 진출

---

## 부록: 기술 스택 진화

### Phase 1 추가
- TemplateEngine, TemplateRegistry
- TossDefaultTemplate (12 타입)
- slideData 타입 필드

### Phase 2 추가
- Editor 페이지 및 라우팅
- 12개 타입별 편집 폼
- updateSlide Store 액션

### Phase 3 예정
- react-beautiful-dnd
- 히스토리 스택 구조
- 이미지 업로드

### Phase 4 예정
- @apps-in-toss/web-framework
- Zustand persist (구독 상태)
- 서버 사이드 결제 검증

---

**문서 버전**: 1.0
**최종 수정일**: 2025-11-06
**작성자**: PPT Maker Team
